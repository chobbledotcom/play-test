Run options: exclude {screenshot: true}

Randomized with seed 59819
.........Capybara starting Puma...
* Version 6.6.1, codename: Return to Forever
* Min threads: 0, max threads: 4
* Listening on http://127.0.0.1:38093
.....................................................‚ö†Ô∏è  SLOW: 4.22s - PDF Complete Integration handles edge cases and validates performance (./spec/features/pdfs/pdf_integration_spec.rb:138)
..‚ö†Ô∏è  SLOW: 2.47s - PDF Complete Integration validates i18n coverage across different PDF scenarios (./spec/features/pdfs/pdf_integration_spec.rb:105)
..........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................‚ö†Ô∏è  SLOW: 3.11s - Dirty form warning warns before navigating away with unsaved changes (./spec/features/inspections/dirty_form_warning_spec.rb:32)
.‚ö†Ô∏è  SLOW: 2.56s - Dirty form warning tracks form changes and provides save options (./spec/features/inspections/dirty_form_warning_spec.rb:17)
.............................................................................................................................................................................‚ö†Ô∏è  SLOW: 2.83s - Safety Standards Comprehensive Tests JavaScript tests Multiple form interactions all forms work independently (./spec/features/safety_standards/safety_standards_comprehensive_spec.rb:90)
.....................‚ö†Ô∏è  SLOW: 2.17s - Safety Standards with Turbo multiple form interactions updates each form independently (./spec/features/safety_standards/safety_standards_turbo_spec.rb:49)
........................................................................................................................F.F...F..F............‚ö†Ô∏è  SLOW: 2.63s - Unit Deletion Restrictions when unit has no inspections successfully deletes unit via UI with JavaScript (./spec/features/units/unit_deletion_restrictions_spec.rb:46)
............................F....FFFFFF.................................................................................................‚ö†Ô∏è  SLOW: 3.60s - PdfGeneratorService.generate_inspection_report does not exceed 3 pages for inspection PDFs (./spec/services/pdf_generator_service_spec.rb:27)
.................................................................................................‚ö†Ô∏è  SLOW: 14.53s - Complete Inspection Workflow complete workflow without js (./spec/features/inspections/complete_inspection_workflow_spec.rb:7)
.‚ö†Ô∏è  SLOW: 6.85s - Complete Inspection Workflow complete workflow with bouncing pillow unit (./spec/features/inspections/complete_inspection_workflow_spec.rb:14)
........................................................[1/10] app/views/users/index.html.erb                               ......[1/10] app/views/users/index.html.erb                               ‚úÖ (2.5s)
...........................‚ö†Ô∏è  SLOW: 14.15s - PDF Comprehensive Testing comprehensive PDF functionality with all edge cases (./spec/features/pdfs/pdf_comprehensive_spec.rb:18)
.........................‚ö†Ô∏è  SLOW: 2.05s - Unit edit dirty form tracks form changes and clears unsaved indicator after save (./spec/features/units/unit_edit_dirty_form_spec.rb:14)
.‚ö†Ô∏è  SLOW: 3.22s - Unit edit dirty form warns before navigating away with unsaved changes (./spec/features/units/unit_edit_dirty_form_spec.rb:39)
.........................................................................................‚ö†Ô∏è  SLOW: 3.97s - Image resize functionality handles JPEG uploads correctly (./spec/features/units/image_resize_spec.rb:64)
.‚ö†Ô∏è  SLOW: 2.92s - Image resize functionality preserves small images unchanged (./spec/features/units/image_resize_spec.rb:128)
.‚ö†Ô∏è  SLOW: 3.98s - Image resize functionality resizes large images to JPEG before upload (./spec/features/units/image_resize_spec.rb:11)
...........................................................................................................................................................................................................................................................F.............................F...................................................................................FF.FFFF.....................................................................................................................................................................................................................................................................................F..FF.FF..................................................................................................................................................................................................................................................................................‚ö†Ô∏è  SLOW: 12.44s - Turbo incomplete fields update incomplete fields count updates dynamically when saving form (./spec/features/inspections/turbo_incomplete_fields_spec.rb:23)
...................................................................FF...............‚ö†Ô∏è  SLOW: 8.48s - Users Seed Data Management POST /users/:id/add_seeds as admin when user has no seed data adds seed data and redirects with success message (./spec/requests/users/users_seed_data_spec.rb:13)
....

Failures:

  1) Badge Management displaying batch count in index
     Failure/Error:
       within("li", text: batch.id.to_s) do
         expect(page).to have_content("25")
       end

     Capybara::Ambiguous:
       Ambiguous match, found 2 elements matching visible css "li" with text "2"
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:310:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:363:in 'Capybara::Session#within'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#within_element'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/rspec/matcher_proxies.rb:15:in 'Capybara::RSpecMatcherProxies#within'
     # ./spec/features/badges/badge_management_spec.rb:151:in 'block (2 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  2) Badge Management clicking batch row navigates to batch edit
     Failure/Error:
       within("li", text: batch.id.to_s) do
         click_link
       end

     Capybara::Ambiguous:
       Ambiguous match, found 2 elements matching visible css "li" with text "2"
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:310:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:363:in 'Capybara::Session#within'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#within_element'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/rspec/matcher_proxies.rb:15:in 'Capybara::RSpecMatcherProxies#within'
     # ./spec/features/badges/badge_management_spec.rb:124:in 'block (2 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  3) Badge Management badge batch shows correct badge count
     Failure/Error:
       within("li", text: batch.id.to_s) do
         expect(page).to have_content("3")
       end

     Capybara::Ambiguous:
       Ambiguous match, found 2 elements matching visible css "li" with text "2"
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:310:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:363:in 'Capybara::Session#within'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#within_element'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/rspec/matcher_proxies.rb:15:in 'Capybara::RSpecMatcherProxies#within'
     # ./spec/features/badges/badge_management_spec.rb:89:in 'block (2 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  4) Badge Management admin can view badge batch details
     Failure/Error:
       within("li", text: batch.id.to_s) do
         click_link
       end

     Capybara::Ambiguous:
       Ambiguous match, found 2 elements matching visible css "li" with text "2"
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:310:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:363:in 'Capybara::Session#within'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#within_element'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/rspec/matcher_proxies.rb:15:in 'Capybara::RSpecMatcherProxies#within'
     # ./spec/features/badges/badge_management_spec.rb:44:in 'block (2 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  5) Unit Badge Validation ID field immutability on edit shows badge ID in display format on edit page
     Failure/Error: expect(page).to have_content(badge.id)
       expected to find text "DY9KPS8A" in "Inspections Units Search Settings Safety Standards About\nLog Out\nEdit Unit\nView Inspections Edit PDF Report Log\nDelete\nAdd Inspection\nUnit Form\nUnit Details Unit Name Unit Type Bouncy Castle Bouncing Pillow\nController / Owner All (1)\nPhoto\nManufacture Manufacture Date\nManufacturer All (1)\nManufacturer Serial Number Description Test Bouncy Castle\nData ID\nF2XJDF2G\nReports\nUnit: PDF Share / QR Code / JSON Last Inspection: No complete inspections are saved for this unit\nDelete\nü§ç Feedback"
     # ./spec/features/units/unit_badges_spec.rb:158:in 'block (3 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  6) Unit Badge Validation when UNIT_BADGES is enabled creates unit with valid badge ID
     Failure/Error: fill_in field_label, with: value

     Capybara::ElementNotFound:
       Unable to find field "ID" that is not disabled
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'
     # ./spec/support/form_helpers.rb:13:in 'FormHelpers#fill_in_form'
     # ./spec/features/units/unit_badges_spec.rb:30:in 'block (3 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  7) Unit Badge Validation when UNIT_BADGES is enabled shows ID field on new unit form
     Failure/Error: expect(page).to have_field(field_label)
       expected to find field "ID" that is not disabled but there were no matches
     # ./spec/support/form_helpers.rb:70:in 'FormHelpers#expect_field_present'
     # ./spec/features/units/unit_badges_spec.rb:26:in 'block (3 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  8) Unit Badge Validation when UNIT_BADGES is enabled shows error when ID is blank
     Failure/Error: expect(page).to have_content("can't be blank")
       expected to find text "can't be blank" in "Inspections Units Search Settings Safety Standards About\nLog Out\nUnit created\nUnit Details\nView Inspections Edit PDF Report Log\nDelete\nAdd Inspection\nUnit Name: Test Unit ID: WBJK32EJ Manufacturer: Test Manufacturer Manufacturer Serial Number: TEST123 Description: Test description Controller / Owner: Test Operator Reports: PDF Share / QR Code / JSON\nInspection History\nNo inspections recorded for this unit.\nUnit Report\nYour browser does not support PDFs Download PDF.\nü§ç Feedback"
     # ./spec/features/units/unit_badges_spec.rb:96:in 'block (3 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  9) Unit Badge Validation when UNIT_BADGES is enabled redirects to existing unit when ID already exists
     Failure/Error: fill_in field_label, with: value

     Capybara::ElementNotFound:
       Unable to find field "ID" that is not disabled
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
     # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'
     # ./spec/support/form_helpers.rb:13:in 'FormHelpers#fill_in_form'
     # ./spec/features/units/unit_badges_spec.rb:61:in 'block (3 levels) in <top (required)>'
     # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  10) Unit Badge Validation when UNIT_BADGES is enabled normalizes ID by stripping spaces and uppercasing
      Failure/Error: fill_in field_label, with: value

      Capybara::ElementNotFound:
        Unable to find field "ID" that is not disabled
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'
      # ./spec/support/form_helpers.rb:13:in 'FormHelpers#fill_in_form'
      # ./spec/features/units/unit_badges_spec.rb:46:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  11) Unit Badge Validation when UNIT_BADGES is enabled shows error when badge ID is invalid
      Failure/Error: fill_in field_label, with: value

      Capybara::ElementNotFound:
        Unable to find field "ID" that is not disabled
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:312:in 'block in Capybara::Node::Finders#synced_resolve'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:301:in 'Capybara::Node::Finders#synced_resolve'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/finders.rb:60:in 'Capybara::Node::Finders#find'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:91:in 'Capybara::Node::Actions#fill_in'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#fill_in'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#fill_in'
      # ./spec/support/form_helpers.rb:13:in 'FormHelpers#fill_in_form'
      # ./spec/features/units/unit_badges_spec.rb:75:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  12) Units When logged in GET /units/new displays new unit form
      Failure/Error:
        expect(page).to have_content(field_label),
          "Expected to find field '#{field_key}' with label '#{field_label}' on the page"

        Expected to find field 'size' with label 'Size' on the page
      # ./spec/support/form_helpers.rb:114:in 'block in FormHelpers#expect_form_fields_present'
      # ./spec/support/form_helpers.rb:111:in 'Hash#each'
      # ./spec/support/form_helpers.rb:111:in 'FormHelpers#expect_form_fields_present'
      # ./spec/requests/units/units_spec.rb:143:in 'block (4 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  13) Units Unit badge ID immutability ignores ID parameter in update requests
      Failure/Error: expect(unit_with_badge.id).to eq(badge1.id)

        expected: #<Encoding:US-ASCII> "T94MKXBK"
             got: #<Encoding:UTF-8> "ZJ59XM4G"

        (compared using ==)
      # ./spec/requests/units/units_spec.rb:690:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  14) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #badge_id_valid validates ID presence
      Failure/Error: expect(unit).not_to be_valid
        expected #<Unit id: nil, name: "Test Unit 876", user_id: "QG4MW2SB", created_at: nil, updated_at: nil, manufacturer: "Test Manufacturer", description: "Test Bouncy Castle", operator: "Test Operator", manufacture_date: "2024-10-13", is_seed: false, serial: "5396bf6ab376f0258b00", unit_type: "bouncy_castle"> not to be valid
      # ./spec/models/unit_spec.rb:141:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  15) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #badge_id_valid prevents save when badge ID does not exist
      Failure/Error: expect(unit.save).to be false

        expected false
             got true
      # ./spec/models/unit_spec.rb:134:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  16) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id strips spaces from ID
      Failure/Error: expect(unit.id).to eq("ABCDEFGH")

        expected: "ABCDEFGH"
             got: "AB CD EF GH"

        (compared using ==)
      # ./spec/models/unit_spec.rb:101:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  17) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id handles combination of spaces, lowercase, and extra chars
      Failure/Error: expect(unit.id).to eq("ABCDEFGH")

        expected: "ABCDEFGH"
             got: "  ab cd ef gh  ij kl"

        (compared using ==)
      # ./spec/models/unit_spec.rb:119:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  18) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id uppercases ID
      Failure/Error: expect(unit.id).to eq("ABCDEFGH")

        expected: "ABCDEFGH"
             got: "abcdefgh"

        (compared using ==)
      # ./spec/models/unit_spec.rb:107:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  19) Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id trims ID to 8 characters
      Failure/Error: expect(unit.id).to eq("ABCDEFGH")

        expected: "ABCDEFGH"
             got: "ABCDEFGHIJKLMNOP"

        (compared using ==)
      # ./spec/models/unit_spec.rb:113:in 'block (5 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  20) Creating inspection from unit search when UNIT_BADGES is enabled user searches for unit and creates inspection
      Failure/Error: <%= button_to t('inspections.buttons.create_inspection_for_unit'),

      ActionView::Template::Error:
        undefined method 'stringify_keys' for an instance of String
      # ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'
      # ./app/controllers/application_controller.rb:165:in 'ApplicationController#n_plus_one_detection'
      # ./.gems/gems/turbo-rails-2.0.13/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # ./.gems/gems/turbo-rails-2.0.13/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # ./.gems/gems/rack-3.2.0/lib/rack/tempfile_reaper.rb:20:in 'Rack::TempfileReaper#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/etag.rb:29:in 'Rack::ETag#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/conditional_get.rb:31:in 'Rack::ConditionalGet#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/head.rb:15:in 'Rack::Head#call'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:274:in 'Rack::Session::Abstract::Persisted#context'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:268:in 'Rack::Session::Abstract::Persisted#call'
      # ./.gems/gems/sentry-rails-5.26.0/lib/sentry/rails/rescued_exception_interceptor.rb:11:in 'Sentry::Rails::RescuedExceptionInterceptor#call'
      # ./.gems/gems/sentry-ruby-5.26.0/lib/sentry/rack/capture_exceptions.rb:15:in 'Sentry::Rack::CaptureExceptions#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:41:in 'Rails::Rack::Logger#call_app'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:29:in 'Rails::Rack::Logger#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/method_override.rb:28:in 'Rack::MethodOverride#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/runtime.rb:24:in 'Rack::Runtime#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/sendfile.rb:114:in 'Rack::Sendfile#call'
      # ./.gems/gems/rack-cors-3.0.0/lib/rack/cors.rb:102:in 'Rack::Cors#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/engine.rb:535:in 'Rails::Engine#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:76:in 'block in Rack::URLMap#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Array#each'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Rack::URLMap#call'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:360:in 'Rack::Test::Session#process_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:163:in 'Rack::Test::Session#custom_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:112:in 'Rack::Test::Session#get'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:81:in 'Capybara::RackTest::Browser#process'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:56:in 'Capybara::RackTest::Browser#process_and_follow_redirects'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:40:in 'Capybara::RackTest::Browser#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/form.rb:57:in 'Capybara::RackTest::Form#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:69:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:172:in 'block in Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'block in Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:171:in 'Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:58:in 'Capybara::Node::Actions#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#click_button'
      # ./spec/features/inspections/new_from_unit_spec.rb:37:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'stringify_keys' for an instance of String
      #   ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'

  21) Creating inspection from unit search when UNIT_BADGES is enabled user can find units created by other users
      Failure/Error: <%= button_to t('inspections.buttons.create_inspection_for_unit'),

      ActionView::Template::Error:
        undefined method 'stringify_keys' for an instance of String
      # ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'
      # ./app/controllers/application_controller.rb:165:in 'ApplicationController#n_plus_one_detection'
      # ./.gems/gems/turbo-rails-2.0.13/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # ./.gems/gems/turbo-rails-2.0.13/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # ./.gems/gems/rack-3.2.0/lib/rack/tempfile_reaper.rb:20:in 'Rack::TempfileReaper#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/etag.rb:29:in 'Rack::ETag#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/conditional_get.rb:31:in 'Rack::ConditionalGet#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/head.rb:15:in 'Rack::Head#call'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:274:in 'Rack::Session::Abstract::Persisted#context'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:268:in 'Rack::Session::Abstract::Persisted#call'
      # ./.gems/gems/sentry-rails-5.26.0/lib/sentry/rails/rescued_exception_interceptor.rb:11:in 'Sentry::Rails::RescuedExceptionInterceptor#call'
      # ./.gems/gems/sentry-ruby-5.26.0/lib/sentry/rack/capture_exceptions.rb:15:in 'Sentry::Rack::CaptureExceptions#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:41:in 'Rails::Rack::Logger#call_app'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:29:in 'Rails::Rack::Logger#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/method_override.rb:28:in 'Rack::MethodOverride#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/runtime.rb:24:in 'Rack::Runtime#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/sendfile.rb:114:in 'Rack::Sendfile#call'
      # ./.gems/gems/rack-cors-3.0.0/lib/rack/cors.rb:102:in 'Rack::Cors#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/engine.rb:535:in 'Rails::Engine#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:76:in 'block in Rack::URLMap#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Array#each'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Rack::URLMap#call'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:360:in 'Rack::Test::Session#process_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:163:in 'Rack::Test::Session#custom_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:112:in 'Rack::Test::Session#get'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:81:in 'Capybara::RackTest::Browser#process'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:56:in 'Capybara::RackTest::Browser#process_and_follow_redirects'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:40:in 'Capybara::RackTest::Browser#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/form.rb:57:in 'Capybara::RackTest::Form#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:69:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:172:in 'block in Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'block in Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:171:in 'Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:58:in 'Capybara::Node::Actions#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#click_button'
      # ./spec/features/inspections/new_from_unit_spec.rb:95:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'stringify_keys' for an instance of String
      #   ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'

  22) Creating inspection from unit search when UNIT_BADGES is enabled user searches with spaces and lowercase (normalized)
      Failure/Error: <%= button_to t('inspections.buttons.create_inspection_for_unit'),

      ActionView::Template::Error:
        undefined method 'stringify_keys' for an instance of String
      # ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'
      # ./app/controllers/application_controller.rb:165:in 'ApplicationController#n_plus_one_detection'
      # ./.gems/gems/turbo-rails-2.0.13/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # ./.gems/gems/turbo-rails-2.0.13/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # ./.gems/gems/rack-3.2.0/lib/rack/tempfile_reaper.rb:20:in 'Rack::TempfileReaper#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/etag.rb:29:in 'Rack::ETag#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/conditional_get.rb:31:in 'Rack::ConditionalGet#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/head.rb:15:in 'Rack::Head#call'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:274:in 'Rack::Session::Abstract::Persisted#context'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:268:in 'Rack::Session::Abstract::Persisted#call'
      # ./.gems/gems/sentry-rails-5.26.0/lib/sentry/rails/rescued_exception_interceptor.rb:11:in 'Sentry::Rails::RescuedExceptionInterceptor#call'
      # ./.gems/gems/sentry-ruby-5.26.0/lib/sentry/rack/capture_exceptions.rb:15:in 'Sentry::Rack::CaptureExceptions#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:41:in 'Rails::Rack::Logger#call_app'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:29:in 'Rails::Rack::Logger#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/method_override.rb:28:in 'Rack::MethodOverride#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/runtime.rb:24:in 'Rack::Runtime#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/sendfile.rb:114:in 'Rack::Sendfile#call'
      # ./.gems/gems/rack-cors-3.0.0/lib/rack/cors.rb:102:in 'Rack::Cors#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/engine.rb:535:in 'Rails::Engine#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:76:in 'block in Rack::URLMap#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Array#each'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Rack::URLMap#call'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:360:in 'Rack::Test::Session#process_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:163:in 'Rack::Test::Session#custom_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:112:in 'Rack::Test::Session#get'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:81:in 'Capybara::RackTest::Browser#process'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:56:in 'Capybara::RackTest::Browser#process_and_follow_redirects'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:40:in 'Capybara::RackTest::Browser#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/form.rb:57:in 'Capybara::RackTest::Form#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:69:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:172:in 'block in Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'block in Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:171:in 'Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:58:in 'Capybara::Node::Actions#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#click_button'
      # ./spec/features/inspections/new_from_unit_spec.rb:55:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'stringify_keys' for an instance of String
      #   ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'

  23) Creating inspection from unit search when UNIT_BADGES is enabled unit with photo displays photo
      Failure/Error: <%= button_to t('inspections.buttons.create_inspection_for_unit'),

      ActionView::Template::Error:
        undefined method 'stringify_keys' for an instance of String
      # ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'
      # ./app/controllers/application_controller.rb:165:in 'ApplicationController#n_plus_one_detection'
      # ./.gems/gems/turbo-rails-2.0.13/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # ./.gems/gems/turbo-rails-2.0.13/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # ./.gems/gems/rack-3.2.0/lib/rack/tempfile_reaper.rb:20:in 'Rack::TempfileReaper#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/etag.rb:29:in 'Rack::ETag#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/conditional_get.rb:31:in 'Rack::ConditionalGet#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/head.rb:15:in 'Rack::Head#call'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:274:in 'Rack::Session::Abstract::Persisted#context'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:268:in 'Rack::Session::Abstract::Persisted#call'
      # ./.gems/gems/sentry-rails-5.26.0/lib/sentry/rails/rescued_exception_interceptor.rb:11:in 'Sentry::Rails::RescuedExceptionInterceptor#call'
      # ./.gems/gems/sentry-ruby-5.26.0/lib/sentry/rack/capture_exceptions.rb:15:in 'Sentry::Rack::CaptureExceptions#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:41:in 'Rails::Rack::Logger#call_app'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:29:in 'Rails::Rack::Logger#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/method_override.rb:28:in 'Rack::MethodOverride#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/runtime.rb:24:in 'Rack::Runtime#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/sendfile.rb:114:in 'Rack::Sendfile#call'
      # ./.gems/gems/rack-cors-3.0.0/lib/rack/cors.rb:102:in 'Rack::Cors#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/engine.rb:535:in 'Rails::Engine#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:76:in 'block in Rack::URLMap#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Array#each'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Rack::URLMap#call'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:360:in 'Rack::Test::Session#process_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:163:in 'Rack::Test::Session#custom_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:112:in 'Rack::Test::Session#get'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:81:in 'Capybara::RackTest::Browser#process'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:56:in 'Capybara::RackTest::Browser#process_and_follow_redirects'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:40:in 'Capybara::RackTest::Browser#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/form.rb:57:in 'Capybara::RackTest::Form#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:69:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:172:in 'block in Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'block in Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:171:in 'Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:58:in 'Capybara::Node::Actions#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#click_button'
      # ./spec/features/inspections/new_from_unit_spec.rb:107:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'stringify_keys' for an instance of String
      #   ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'

  24) Creating inspection from unit search when UNIT_BADGES is enabled unit with last inspection displays size
      Failure/Error: <%= button_to t('inspections.buttons.create_inspection_for_unit'),

      ActionView::Template::Error:
        undefined method 'stringify_keys' for an instance of String
      # ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'
      # ./app/controllers/application_controller.rb:165:in 'ApplicationController#n_plus_one_detection'
      # ./.gems/gems/turbo-rails-2.0.13/lib/turbo-rails.rb:24:in 'Turbo.with_request_id'
      # ./.gems/gems/turbo-rails-2.0.13/app/controllers/concerns/turbo/request_id_tracking.rb:10:in 'Turbo::RequestIdTracking#turbo_tracking_request_id'
      # ./.gems/gems/rack-3.2.0/lib/rack/tempfile_reaper.rb:20:in 'Rack::TempfileReaper#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/etag.rb:29:in 'Rack::ETag#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/conditional_get.rb:31:in 'Rack::ConditionalGet#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/head.rb:15:in 'Rack::Head#call'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:274:in 'Rack::Session::Abstract::Persisted#context'
      # ./.gems/gems/rack-session-2.1.1/lib/rack/session/abstract/id.rb:268:in 'Rack::Session::Abstract::Persisted#call'
      # ./.gems/gems/sentry-rails-5.26.0/lib/sentry/rails/rescued_exception_interceptor.rb:11:in 'Sentry::Rails::RescuedExceptionInterceptor#call'
      # ./.gems/gems/sentry-ruby-5.26.0/lib/sentry/rack/capture_exceptions.rb:15:in 'Sentry::Rack::CaptureExceptions#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:41:in 'Rails::Rack::Logger#call_app'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/rack/logger.rb:29:in 'Rails::Rack::Logger#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/method_override.rb:28:in 'Rack::MethodOverride#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/runtime.rb:24:in 'Rack::Runtime#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/sendfile.rb:114:in 'Rack::Sendfile#call'
      # ./.gems/gems/rack-cors-3.0.0/lib/rack/cors.rb:102:in 'Rack::Cors#call'
      # ./.gems/gems/railties-8.0.2.1/lib/rails/engine.rb:535:in 'Rails::Engine#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:76:in 'block in Rack::URLMap#call'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Array#each'
      # ./.gems/gems/rack-3.2.0/lib/rack/urlmap.rb:60:in 'Rack::URLMap#call'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:360:in 'Rack::Test::Session#process_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:163:in 'Rack::Test::Session#custom_request'
      # ./.gems/gems/rack-test-2.2.0/lib/rack/test.rb:112:in 'Rack::Test::Session#get'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:81:in 'Capybara::RackTest::Browser#process'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:56:in 'Capybara::RackTest::Browser#process_and_follow_redirects'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/browser.rb:40:in 'Capybara::RackTest::Browser#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/form.rb:57:in 'Capybara::RackTest::Form#submit'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:69:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/rack_test/node.rb:131:in 'Capybara::RackTest::Node#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:172:in 'block in Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'block in Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/base.rb:84:in 'Capybara::Node::Base#synchronize'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:608:in 'Capybara::Node::Element#perform_click_action'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/element.rb:171:in 'Capybara::Node::Element#click'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/node/actions.rb:58:in 'Capybara::Node::Actions#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/session.rb:774:in 'Capybara::Session#click_button'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Method#call'
      # ./.gems/gems/capybara-3.40.0/lib/capybara/dsl.rb:52:in 'Capybara::DSL#click_button'
      # ./spec/features/inspections/new_from_unit_spec.rb:118:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # NoMethodError:
      #   undefined method 'stringify_keys' for an instance of String
      #   ./app/views/inspections/new_from_unit.html.erb:44:in '_app_views_inspections_new_from_unit_html_erb__3761283618531221278_185512'

  25) Unit creation company restriction when user has an inspection company user can see the new unit button and create units
      Failure/Error:
        expect(page).to have_content(field_label),
          "Expected to find field '#{field_key}' with label '#{field_label}' on the page"

        Expected to find field 'size' with label 'Size' on the page
      # ./spec/support/form_helpers.rb:114:in 'block in FormHelpers#expect_form_fields_present'
      # ./spec/support/form_helpers.rb:111:in 'Hash#each'
      # ./spec/support/form_helpers.rb:111:in 'FormHelpers#expect_form_fields_present'
      # ./spec/features/units/unit_creation_company_restriction_spec.rb:21:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

  26) Unit creation company restriction when user has an inspection company demonstrates comprehensive form helper usage
      Failure/Error:
        expect(page).to have_content(field_label),
          "Expected to find field '#{field_key}' with label '#{field_label}' on the page"

        Expected to find field 'size' with label 'Size' on the page
      # ./spec/support/form_helpers.rb:114:in 'block in FormHelpers#expect_form_fields_present'
      # ./spec/support/form_helpers.rb:111:in 'Hash#each'
      # ./spec/support/form_helpers.rb:111:in 'FormHelpers#expect_form_fields_present'
      # ./spec/features/units/unit_creation_company_restriction_spec.rb:38:in 'block (3 levels) in <top (required)>'
      # ./spec/support/slow_test_detector.rb:39:in 'block (2 levels) in <top (required)>'

Finished in 8 minutes 0 seconds (files took 8.19 seconds to load)
2398 examples, 26 failures

Failed examples:

rspec ./spec/features/badges/badge_management_spec.rb:146 # Badge Management displaying batch count in index
rspec ./spec/features/badges/badge_management_spec.rb:119 # Badge Management clicking batch row navigates to batch edit
rspec ./spec/features/badges/badge_management_spec.rb:83 # Badge Management badge batch shows correct badge count
rspec ./spec/features/badges/badge_management_spec.rb:40 # Badge Management admin can view badge batch details
rspec ./spec/features/units/unit_badges_spec.rb:156 # Unit Badge Validation ID field immutability on edit shows badge ID in display format on edit page
rspec ./spec/features/units/unit_badges_spec.rb:29 # Unit Badge Validation when UNIT_BADGES is enabled creates unit with valid badge ID
rspec ./spec/features/units/unit_badges_spec.rb:25 # Unit Badge Validation when UNIT_BADGES is enabled shows ID field on new unit form
rspec ./spec/features/units/unit_badges_spec.rb:87 # Unit Badge Validation when UNIT_BADGES is enabled shows error when ID is blank
rspec ./spec/features/units/unit_badges_spec.rb:58 # Unit Badge Validation when UNIT_BADGES is enabled redirects to existing unit when ID already exists
rspec ./spec/features/units/unit_badges_spec.rb:43 # Unit Badge Validation when UNIT_BADGES is enabled normalizes ID by stripping spaces and uppercasing
rspec ./spec/features/units/unit_badges_spec.rb:74 # Unit Badge Validation when UNIT_BADGES is enabled shows error when badge ID is invalid
rspec ./spec/requests/units/units_spec.rb:133 # Units When logged in GET /units/new displays new unit form
rspec ./spec/requests/units/units_spec.rb:679 # Units Unit badge ID immutability ignores ID parameter in update requests
rspec ./spec/models/unit_spec.rb:139 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #badge_id_valid validates ID presence
rspec ./spec/models/unit_spec.rb:132 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #badge_id_valid prevents save when badge ID does not exist
rspec ./spec/models/unit_spec.rb:98 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id strips spaces from ID
rspec ./spec/models/unit_spec.rb:116 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id handles combination of spaces, lowercase, and extra chars
rspec ./spec/models/unit_spec.rb:104 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id uppercases ID
rspec ./spec/models/unit_spec.rb:110 # Unit UNIT_BADGES feature when UNIT_BADGES is enabled #normalize_id trims ID to 8 characters
rspec ./spec/features/inspections/new_from_unit_spec.rb:30 # Creating inspection from unit search when UNIT_BADGES is enabled user searches for unit and creates inspection
rspec ./spec/features/inspections/new_from_unit_spec.rb:87 # Creating inspection from unit search when UNIT_BADGES is enabled user can find units created by other users
rspec ./spec/features/inspections/new_from_unit_spec.rb:51 # Creating inspection from unit search when UNIT_BADGES is enabled user searches with spaces and lowercase (normalized)
rspec ./spec/features/inspections/new_from_unit_spec.rb:101 # Creating inspection from unit search when UNIT_BADGES is enabled unit with photo displays photo
rspec ./spec/features/inspections/new_from_unit_spec.rb:112 # Creating inspection from unit search when UNIT_BADGES is enabled unit with last inspection displays size
rspec ./spec/features/units/unit_creation_company_restriction_spec.rb:11 # Unit creation company restriction when user has an inspection company user can see the new unit button and create units
rspec ./spec/features/units/unit_creation_company_restriction_spec.rb:35 # Unit creation company restriction when user has an inspection company demonstrates comprehensive form helper usage

Randomized with seed 59819

Coverage report generated for Unit Tests to /home/user/git/play-test/coverage.
Line Coverage: 94.36% (4771 / 5056)
Branch Coverage: 80.85% (1119 / 1384)
