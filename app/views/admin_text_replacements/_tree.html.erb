<%
  tree_local = local_assigns[:tree]
  level = local_assigns[:level] || 0
  parent_key = local_assigns[:parent_key] || ""
%>

<ul style="margin-left: <%= level * 20 %>px;">
  <% tree_local.each do |key, subtree| %>
    <% full_key = parent_key.present? ? "#{parent_key}.#{key}" : key %>
    <li>
      <strong><%= key %></strong>
      <% if subtree.is_a?(Hash) %>
        <% if subtree.key?(:_value) %>
          <div style="margin-left: 20px;">
            <%= t('admin_text_replacements.tree.value', value: subtree[:_value]) %>
            <%= button_to(
              admin_text_replacement_path(subtree[:_id]),
              method: :delete,
              data: { turbo_confirm: "Are you sure?" },
              style: "display: inline; margin-left: 10px;"
            ) do %>
              <%= t('admin_text_replacements.buttons.delete') %>
            <% end %>
          </div>
        <% end %>
        <% if subtree.except(:_value, :_id).any? %>
          <%= render 'tree', tree: subtree.except(:_value, :_id), level: level + 1, parent_key: full_key %>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>
