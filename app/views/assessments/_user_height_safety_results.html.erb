<%# User Height Safety Standards Results Partial %>
<%= render 'shared/safety_info_box',
  content: -> do %>
  <% structure = @assessment.inspection.structure_assessment %>
  <% if structure&.platform_height.present? && @assessment.containing_wall_height.present? %>
    <% platform_height = structure.platform_height %>
    <% slide_assessment = @assessment.inspection.slide_assessment %>
    <% has_permanent_roof = slide_assessment&.slide_permanent_roof %>
    
    <% # Loop through the four preset heights %>
    <% [1.0, 1.2, 1.5, 1.8].each do |user_height| %>
      <% wall_details = EN14960::Calculators::SlideCalculator.get_wall_height_requirement_details(
           platform_height / 1000.0, # Convert mm to m
           user_height,
           has_permanent_roof
         ) %>

      <%= render 'assessments/safety_standard_with_breakdown',
          title: "#{t('safety_standards.user_height.height_requirements')} (#{user_height}m users)",
          calculator_result: wall_details,
          passed: structure.meets_height_requirements? %>
    <% end %>
  <% end %>

<% end %>
